!function(e,n,t){var a=e.location.href,r={selector:"a",container:"body",hash:"main",indexPage:"index.html",paths:"",refreshtoIndex:!0},i={refreshHandle:function(n){var t=this;t.onRefresh(function(){e.name=e.location.hash});var a=e.location.href,r=a.substring(a.lastIndexOf("/")),i=a.replace(r,"/"+n.paths+"/"+e.name.replace("#","")+".html");t.ajaxHandle(i,n.container)},refreshToIndex:function(n){var t=this;t.onRefresh(function(){var n=e.location.href.replace(e.location.hash,"#"+r.hash);e.history.pushState({origin:n},null,i)});var i="";a.indexOf(".html")>=0?(i=a.replace(a.substring(a.indexOf("#")),"#"+n.hash),e.location.href=i):e.location.href=a+n.indexPage+"#"+n.hash},onRefresh:function(n){e.onbeforeunload=function(t){var a=t||e.event,r=a.screenX-e.screenLeft,i=r>document.documentElement.scrollWidth-20;i&&a.clientY<0||a.altKey||n()}},init:function(t){var i=this;n(t.selector||t.selector).click(function(o){o.preventDefault();var l=n(this).data("target"),s=e.location.href.split("#")[1]||t.hash||r.hash,h="",f="",c="";a.indexOf(".html")<0?a.indexOf("#")<0?h=(c=i.queryFilter())?a.replace(c,"")+(t.indexPage||r.indexPage)+"#"+l:a+(t.indexPage||r.indexPage)+"#"+l:((c=i.queryFilter())&&(h=a.replace(c,(t.indexPage||r.indexPage)+c)),f=a.substring(a.indexOf("#")),h=a.replace(f,(t.indexPage||r.indexPage)+"#"+l)):a.indexOf("#")<0?h=a+"#"+l:(f=a.substring(a.indexOf("#")),h=a.replace(f,"#"+l)),e.history.pushState({origin:s},null,h);var d=h.substring(h.lastIndexOf("/"));i.ajaxHandle(h.replace(d,"/"+t.paths+"/"+l+".html"),t.container)}),e.onpopstate=function(n){var a="",r=e.location.href,o=r.split("#")[1]||t.indexPage,l=r.substring(r.lastIndexOf("/"));a=r.indexOf("#")<0||r.indexOf("#"+t.hash)>=0?r.lastIndexOf("/")+1==r.length?r+t.paths+"/"+t.hash+".html":r.replace(l,"/"+t.paths+"/"+t.hash+".html"):(repStr=i.queryFilter(r))?r.replace(repStr,t.paths+"/"+o.replace(/\?.*/,"")+".html"):r.replace(l,"/"+t.paths+"/"+o+".html"),i.ajaxHandle(a,t.container)}},ajaxHandle:function(e,t){n.ajax({url:e,type:"get",dataType:"html",headers:{H_PJAX:!0}}).done(function(e){n(t).html(e)}).fail(function(){console.log("加载失败!")}).always(function(){})},queryFilter:function(e){var n="",t="",r=e||a;return!/\#.*\?/.test(r)&&(n=r.indexOf("?"))>=0?t=r.substring(n):/\#.*\?/.test(r)?t=r.substring(r.indexOf("#")):null}};"function"==typeof define&&define.amd?define([],function(){return i}):"object"==typeof module&&"object"==typeof exports?module.exports=i:jQuery?n.extend({htmlPjax:function(e){var n="boolean"==typeof e.refreshToIndex?e.refreshToIndex:r.refreshtoIndex;n?i.refreshToIndex(e):i.refreshHandle(e),i.init(e)}}):e.htmlPajx=i}(window,jQuery);