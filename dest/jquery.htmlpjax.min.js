!function(e,n,t){var a=e.location.href,r={selector:"a",container:"body",hash:"#main",indexPage:"index.html",paths:"",refreshtoIndex:!0},i={refreshHandle:function(){e.onbeforeunload=function(e){alert("===onbeforeunload==="),e.clientX>document.body.clientWidth&&e.clientY<0||e.altKey?alert("你关闭了浏览器"):alert("你正在刷新页面")}},refreshToIndex:function(t){if(n("#"+t.hash)){var r="";a.indexOf(".html")>=0?(r=a.replace(a.substring(a.indexOf("#")),"#"+t.hash),e.location.href=r):e.location.href=a+t.indexPage+"#"+t.hash}},init:function(t){var i=this;n(t.selector||t.selector).click(function(){var l=n(this).data("target"),o=e.location.href.split("#")[1]||t.hash||r.hash,s="",h="",d="";a.indexOf(".html")<0?a.indexOf("#")<0?s=(d=i.queryFilter())?a.replace(d,"")+(t.indexPage||r.indexPage)+"#"+l:a+(t.indexPage||r.indexPage)+"#"+l:((d=i.queryFilter())&&(s=a.replace(d,(t.indexPage||r.indexPage)+d)),h=a.substring(a.indexOf("#")),s=a.replace(h,(t.indexPage||r.indexPage)+"#"+l)):a.indexOf("#")<0?s=a+"#"+l:(h=a.substring(a.indexOf("#")),s=a.replace(h,"#"+l)),e.history.pushState({origin:o},null,s);var f=s.substring(s.lastIndexOf("/"));i.ajaxHandle(s.replace(f,"/"+t.paths+"/"+l+".html"),t.container)}),e.onpopstate=function(n){var a="",r=e.location.href,l=r.split("#")[1]||t.indexPage,o=r.substring(r.lastIndexOf("/"));a=r.indexOf("#")<0||r.indexOf("#"+t.hash)>=0?r.lastIndexOf("/")+1==r.length?r+t.paths+"/"+t.hash+".html":r.replace(o,"/"+t.paths+"/"+t.hash+".html"):(repStr=i.queryFilter(r))?r.replace(repStr,t.paths+"/"+l.replace(/\?.*/,"")+".html"):r.replace(o,"/"+t.paths+"/"+l+".html"),i.ajaxHandle(a,t.container)}},ajaxHandle:function(e,t){n.ajax({url:e,type:"get",dataType:"html",headers:{H_PJAX:!0}}).done(function(e){n(t).html(e)}).fail(function(){console.log("加载失败!")}).always(function(){})},queryFilter:function(e){var n="",t="",r=e||a;return!/\#.*\?/.test(r)&&(n=r.indexOf("?"))>=0?t=r.substring(n):/\#.*\?/.test(r)?t=r.substring(r.indexOf("#")):null}};"function"==typeof define&&define.amd?define([],function(){return i}):"object"==typeof module&&"object"==typeof exports?module.exports=i:jQuery?n.extend({htmlPjax:function(e){e.refreshtoIndex=e.refreshtoIndex||!0,e.refreshtoIndex||r.refreshtoIndex?i.refreshToIndex(e):i.refreshHandle(),i.init(e)}}):e.htmlPajx=i}(window,jQuery);